<!doctype html><html lang=en>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1">
<title>SQL Window Functions Explained [Book]</title>
<meta name=description content="A clear and visual introduction to window functions in SQL.">
<meta name=robots content="index, follow">
<link rel=stylesheet type=text/css href=/assets/css/style.788ff8955ef62cbd24186cef0a739d64e026368ead83dbb22257c12e1d7ce3f2.css>
<link rel=icon href=/assets/favicon/favicon.ico sizes=any>
<link rel=icon type=image/svg+xml href=/assets/favicon/favicon.svg>
<link rel=apple-touch-icon href=/assets/favicon/apple-touch-icon.png>
<link rel=manifest href=/assets/favicon/manifest.json>
<link rel=canonical href=https://antonz.org/sql-window-functions-book/>
<meta name=author content="Anton Zhiyanov">
<meta property="og:type" content="article">
<meta property="og:title" content="SQL Window Functions Explained [Book]">
<meta property="og:description" content="A clear and visual introduction to window functions in SQL.">
<meta property="og:url" content="https://antonz.org/sql-window-functions-book/">
<meta property="og:image" content="https://antonz.org/sql-window-functions-book/cover.png">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:title content="SQL Window Functions Explained [Book]">
<meta name=twitter:description content="A clear and visual introduction to window functions in SQL.">
<meta name=twitter:url content="https://antonz.org/sql-window-functions-book/">
<meta name=twitter:site content="@ohmypy">
<meta name=twitter:image content="https://antonz.org/sql-window-functions-book/cover.png"></head>
<body>
<div class=header>
<div class=container>
<div class=row>
<div class="col-xs-6 col-sm-3">
<a class=img-link href=/>
<img src=/assets/logo.svg class=header-icon>
</a> 
<a href=/>
<strong>Anton Zhiyanov</strong>
</a>
</div>
<div class="col-xs-12 col-sm-6 col-md-4 hidden-mobile">
<a class=menu__link href=/all/>
<span>blog</span>
</a>
<a class=menu__link href=/#about>
<span>contacts</span>
</a>
<a class=menu__link href=https://antonz.ru>
<span>ru</span>
</a>
</div>
<div class="col-xs-6 col-sm-3"><div class=search-module>
<form action=https://duckduckgo.com/>
<input type=hidden name=kf value=-1>
<input type=hidden name=kz value=-1>
<input type=hidden name=kaf value=1>
<input type=hidden name=ko value=-2>
<input type=hidden name=k1 value=-1>
<input type=hidden name=sites value=antonz.org>
<input type=search name=q autocomplete=off placeholder=Search aria-label=Search>
</form>
</div></div>
</div>
</div>
</div>
<div class=storey>
<div class=container>
<article class=post>
<div class=row>
<div class="col-xs-12 col-sm-10 article">
<header>
<h1>SQL Window Functions Explained [Book]</h1>
</header>
<p>Window functions are probably the most confusing section of SQL. You might think, &ldquo;So what? They just came up with some additional functions&rdquo;. Not really. &ldquo;Window functions&rdquo; is a separate language built into regular SQL. And it&rsquo;s more complicated than everything you know about SELECTs.</p>
<p>In short, window functions assist in making great analytical reports without Excel. Maybe you want to calculate monthly sales percentages over the year? Window functions. Split marketing channels into effective and ineffective ones? Window functions. Choose the top 10 clients for each segment? Same.</p>
<div class=row>
<div class="col-xs-12 col-sm-8">
<p>I've read several dozen articles explaining SQL window functions. They all suffered from one of two problems:</p>
<ol>
<li>Easy read without much practical value, describing 10% of features.</li>
<li>Difficult to comprehend. If I did not know the subject — I would not understand a thing.</li>
</ol>
</div>
<div class="col-xs-12 col-sm-4">
<figure>
<img src=queries.png alt="How I see complex queries" class=img-bordered-thin>
<figcaption>
<small>SQL window queries can look like this for an unfamiliar reader.</small>
</figcaption>
</figure>
</div>
</div>
<p>I want people to understand SQL windows better. So I wrote a book — <em>SQL Window Functions Explained</em>.</p>
<h2 id=about-the-book>About the book</h2>
<p>It is a clear and visual introduction to window functions. Clear — because I can describe complex topics in a readable way. Visual — because I have prepared a hundred pictures and GIFs to help you understand SQL windows.</p>
<p>Window functions are a complex topic. So the book only teaches a little at a time. It gives just enough theory and a lot of practice, because it&rsquo;s the only way to turn abstract knowledge into skills.</p>
<div class=row>
<div class="col-xs-6 col-sm-4 col-md-3 col-tile">
<a href=page/01.jpg target=_blank class=img-link>
<img src=peek/01.jpg alt="Book cover" class=img-bordered-thin>
</a>
</div>
<div class="col-xs-6 col-sm-4 col-md-3 col-tile hidden-mobile">
<a href=page/02.png target=_blank class=img-link>
<img src=peek/02.jpg alt="Page 3" class=img-bordered-thin>
</a>
</div>
<div class="col-xs-6 col-sm-4 col-md-3 col-tile hidden-mobile">
<a href=page/03.png target=_blank class=img-link>
<img src=peek/03.jpg alt="Page 15" class=img-bordered-thin>
</a>
</div>
<div class="col-xs-6 col-sm-4 col-md-3 col-tile">
<a href=page/04.png target=_blank class=img-link>
<img src=peek/04.jpg alt="Page 30" class=img-bordered-thin>
</a>
</div>
<div class="col-xs-6 col-sm-4 col-md-3 col-tile">
<a href=page/05.png target=_blank class=img-link>
<img src=peek/05.jpg alt="Page 58" class=img-bordered-thin>
</a>
</div>
<div class="col-xs-6 col-sm-4 col-md-3 col-tile hidden-mobile">
<a href=page/06.png target=_blank class=img-link>
<img src=peek/06.jpg alt="Page 62" class=img-bordered-thin>
</a>
</div>
<div class="col-xs-6 col-sm-4 col-md-3 col-tile hidden-mobile">
<a href=page/07.png target=_blank class=img-link>
<img src=peek/07.jpg alt="Page 88" class=img-bordered-thin>
</a>
</div>
<div class="col-xs-6 col-sm-4 col-md-3 col-tile">
<a href=page/08.png target=_blank class=img-link>
<img src=peek/08.jpg alt="Page 126" class=img-bordered-thin>
</a>
</div>
</div>
<p>A step-by-step narrative combined with numerous visuals helps readers understand the material. Fifty-six interactive exercises with solutions ensure that you master window functions in practice.</p>
<p>You can use the book with any of the following DBMSs:</p>
<ul>
<li>MySQL 8.0.2+ (MariaDB 10.2+)</li>
<li>PostgreSQL 11+</li>
<li>SQLite 3.28+</li>
<li>MS SQL 2012+</li>
<li>Oracle 11g+</li>
</ul>
<p>
<a class=button href=https://antonz.gumroad.com/l/sql-windows>
Get the book
</a>
</p>
<h2 id=what-you-will-learn>What you will learn</h2>
<div class=row>
<div class="col-xs-12 col-sm-6">
<p><a href=/why-use-sql-window-functions>Why use window functions</a></p>
<p>Part 1. Windows and functions</p>
<ul>
<li><a href=/sql-window-functions-ranking>Ranking</a></li>
<li><a href=/sql-window-functions-offset>Offset</a></li>
<li><a href=/sql-window-functions-aggregation>Aggregation</a></li>
<li><a href=/sql-window-functions-rolling-aggregates>Rolling aggregates</a></li>
<li>Statistics</li>
</ul>
<p>Part 2. Frames</p>
<ul>
<li>ROWS and GROUPS</li>
<li>RANGE</li>
<li>EXCLUDE</li>
<li>FILTER</li>
</ul>
<p>Part 3. Practice</p>
<ul>
<li>Finance</li>
<li>Clustering</li>
<li>Data cleaning</li>
</ul>
</div>
<div class="col-xs-12 col-sm-6">
<figure>
<img src=poster.png alt="Book poster" class=img-bordered-thin>
<figcaption>Every chapter covers a single topic in depth</figcaption>
</figure>
</div>
</div>
<details>
<summary>Detailed table of contents</summary>
<div class=boxed>
<p><strong>Introduction</strong></p>
<p>About the book</p>
<p>Why use window functions</p>
<p>Playground</p>
<p><strong>Part 1. Windows and functions</strong></p>
<p>Ranking</p>
<ul>
<li>Window function</li>
<li>Window ordering vs. result ordering</li>
<li>Sorting uniqueness</li>
<li>Multiple windows</li>
<li>Partitions</li>
<li>Groups</li>
<li>Ranking functions</li>
</ul>
<p>Offset</p>
<ul>
<li>Comparing with neighbors</li>
<li>Comparing to boundaries</li>
<li>Window, partition, frame</li>
<li>Comparing to boundaries revisited</li>
<li>Offset functions</li>
</ul>
<p>Aggregation</p>
<ul>
<li>Partitioned aggregates</li>
<li>Filtering and execution order</li>
<li>Window definition</li>
<li>Aggregation functions</li>
</ul>
<p>Rolling aggregates</p>
<ul>
<li>Moving average</li>
<li>Frame</li>
<li>Cumulative total</li>
<li>Default frame</li>
<li>Rolling aggregates functions</li>
</ul>
<p>Statistics</p>
<ul>
<li>Cumulative distribution</li>
<li>Relative rank</li>
<li>Summary statistics</li>
<li>Percentile</li>
<li>Percentile as a window function</li>
<li>Statistics functions</li>
</ul>
<p>Summary</p>
<p><strong>Part 2. Frames</strong></p>
<p>ROWS and GROUPS</p>
<ul>
<li>Frame revisited</li>
<li>Groups frame</li>
</ul>
<p>RANGE</p>
<ul>
<li>Range frame</li>
<li>Range specifics</li>
<li>Frame boundaries</li>
<li>Default frame</li>
<li>Frames FAQ</li>
</ul>
<p>EXCLUDE</p>
<ul>
<li>Excluding rows</li>
<li>Exclude options</li>
</ul>
<p>FILTER</p>
<ul>
<li>Filtering rows</li>
<li>CASE as an alternative to FILTER</li>
</ul>
<p>Summary</p>
<p><strong>Part 3. Practice</strong></p>
<p>Finance</p>
<ul>
<li>Aggregate first, windows later</li>
<li>Windows first, filter later</li>
<li>Aggregation and null</li>
<li>Gold plan sales</li>
<li>Sales by plan for Q1</li>
<li>Platinum plan moving average</li>
<li>Comparison with December</li>
<li>Plans contribution</li>
<li>High/medium/low revenue</li>
<li>2020 vs 2019</li>
<li>Months ranked by revenue</li>
</ul>
<p>Clustering</p>
<ul>
<li>Identifying islands</li>
<li>Islands with duplicates</li>
<li>Date islands</li>
<li>Value clusters</li>
<li>Date clusters</li>
</ul>
<p>Data cleaning</p>
<ul>
<li>Duplicates</li>
<li>Missing values</li>
<li>Previous non-empty value</li>
<li>Outliers</li>
</ul>
<p>Final thoughts</p>
</div>
</details>
<p>The book starts with SQL windows basics (Part 1) and goes through frame nuances (Part 2) to some pretty advanced stuff (Part 3).</p>
<p>To preview the first few chapters, visit the links in the table of contents above.</p>
<h2 id=about-the-author>About the author</h2>
<img src=/assets/antonz.jpg width=60 style=width:60px;float:left;margin-right:1rem>
<p>I&rsquo;m Anton Zhiyanov, a Python/Golang developer and SQLite enthusiast. I work on <a href=https://github.com/nalgeon>open source</a>, teach courses and blog about programming.</p>
<p>In 2021 I launched a course on SQL window functions. It now has 1000+ graduates and an average rating of 5 stars based on 300+ student reviews.</p>
<p>In 2023 I decided to write a book based on the original course. Here it is.</p>
<h2 id=book-details>Book details</h2>
<ul>
<li>296 pages</li>
<li>100+ pictures and GIFs</li>
<li>56 interactive exercises (with solutions)</li>
<li>PDF 17.8 × 23.3 cm (7 × 9.2 inches)</li>
</ul>
<p>
<a class=button href=https://antonz.gumroad.com/l/sql-windows>
Get the ebook for $20
</a>
<span class=nowrap>
or <a href=https://www.amazon.com/dp/B0C47R3N6S>paperback for $35</a>
</span>
</p>
<p><em>Follow <a href=https://twitter.com/ohmypy><strong>@ohmypy</strong></a> on Twitter to keep up with new posts</em> 🚀</p>
</div>
</div><footer class=post__footer>
<div class=row>
<div class=col-xs-12>
<div class=post__date>
<time datetime="2023-01-22 18:00:00 +0000 UTC">22 Jan, 2023</time>
</div>
<div class=post__tags>
<a href=https://antonz.org/tags/data/>data</a>&nbsp;
</div>
</div>
</div>
</footer></article>
<aside class=post__related>
<div class="post__nav article">
<div class=row>
<div class="col-xs-12 col-sm-6">
<p>&larr;&nbsp;<a href=https://antonz.org/atomics-composition/>Atomic operations composition in Go</a></p>
</div>
<div class="col-xs-12 col-sm-6">
<p><a href=https://antonz.org/why-use-sql-window-functions/>Why Use SQL Window Functions</a>&nbsp;&rarr;</p>
</div>
</div>
</div>
<div class=article>
<div class=row>
<div class="col-xs-12 col-sm-8 col-md-6">
<h3>See also</h3>
<p><a href=/sqlean/>The Ultimate SQLite Extension Set</a></p>
<p><a href=/sqlite-3-37/>What's new in SQLite 3.37</a></p>
<p><a href=/dataviz-guide/>Data Visualization Guide</a></p>
</div>
</div>
</div>
</aside>
</div>
</div>
<footer class="container footer">
<ul class=naked-list>
<li class=footer__item>Subscribe:
<a href=https://twitter.com/ohmypy class=footer__social-link>
<i class="fab fa-twitter-1"></i><span>Twitter</span>
</a>
<a href=https://github.com/nalgeon class=footer__social-link>
<i class="fab fa-github-1"></i><span>GitHub</span>
</a>
<a href=https://www.linkedin.com/in/nalgeon/ class=footer__social-link>
<i class="fab fa-linkedin-2"></i><span>LinkedIn</span>
</a>
<a href=/index.xml class=footer__social-link><i class="fas fa-rss"></i><span>RSS</span></a>
</li>
<li class=footer__item>Email: <a href=mailto:m@antonz.org>m@antonz.org</a></li>
</ul>
</footer>
<script async src=//gc.zgo.at/count.js data-goatcounter=https://antonzorg.goatcounter.com/count></script></body>
</html>