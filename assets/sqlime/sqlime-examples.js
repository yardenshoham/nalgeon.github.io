(()=>{function c(i){if(i===null)return"(empty)";let[e,t]=[i.columns,i.values],n="<thead>"+o(e,"th")+"</thead>",s=t.map(function(r){return o(r.map(h),"td")});return n+="<tbody>"+o(s,"tr")+"</tbody>",`<table>${n}</table>`}function u(i){let e="<thead><tr><th>table</th></tr></thead>",t=i.map(function(n){return`<tr>
            <td>
                <button class="sqlime-link" data-action="showTable" data-arg="${n}">
                    ${n}
                </button>
            </td>
        </tr>`});return e+="<tbody>"+t.join(`
`)+"</tbody>",`<table>${e}</table>`}function m(i){return`<pre>${i}</pre>`}function o(i,e){if(i.length===0)return"";let t="<"+e+">",n="</"+e+">";return t+i.join(n+t)+n}function h(i){let e=document.createElement("div");return e.innerText=i,e.innerHTML}var b={printMarkdown:m,printResult:c,printTables:u},l=b;var a=class extends HTMLElement{constructor(){super(),this.database=null,this.examples=[]}connectedCallback(){this.rendered||(this.render(),this.listen(),this.rendered=!0)}render(){let e=this.getAttribute("selector")||"pre",t=this.hasAttribute("editable");document.querySelectorAll(e).forEach(n=>{let s=this.init(n);t&&this.makeEditable(n,s)})}listen(){document.addEventListener("sqlime-ready",e=>{let t=this.getAttribute("db");e.detail.name==t&&(this.database=e.detail.database)})}init(e){let t=document.createElement("div");t.style.display="none";let n=document.createElement("button");n.innerHTML="Run",n.addEventListener("click",p=>{this.execute(e.innerText,t)});let s=document.createElement("div");s.appendChild(n);let r=document.createElement("div");r.className="sqlime-example",r.appendChild(s),r.appendChild(t),e.insertAdjacentElement("afterend",r);let d={commandsEl:s,resultsEl:t};return this.examples.push(d),d}makeEditable(e,t){e.contentEditable="true",e.addEventListener("keydown",s=>!s.ctrlKey&&!s.metaKey?!0:s.keyCode==10||s.keyCode==13?(this.execute(e.innerText,t.resultsEl),!1):!0);let n=document.createElement("a");n.innerHTML="Edit",n.style.cursor="pointer",n.style.display="inline-block",n.style.marginLeft="1em",t.commandsEl.appendChild(n),n.addEventListener("click",s=>(e.focus(),!1))}execute(e,t){if(e=e.trim(),!e){this.showMessage(t,"");return}try{let n=this.getDatabase().execute(e);this.showResult(t,n)}catch(n){this.showMessage(t,n)}}getDatabase(){return this.database==null&&(this.database=this.loadDatabase()),this.database}loadDatabase(){if(!("Sqlime"in window)||!("db"in window.Sqlime))throw new Error("Sqlime is not initialized. Use the 'sqlime-db' component to initialize it.");let e=this.getAttribute("db");if(!e)throw new Error("Missing the 'db' attribute.");if(!(e in window.Sqlime.db))throw new Error(`Database '${e}' is not loaded. Use the 'sqlime-db' component to load it.`);return window.Sqlime.db[e]}showResult(e,t){e.style.display="",e.innerHTML=l.printResult(t)}showMessage(e,t){e.style.display="",e.innerHTML=t}};window.customElements.get("sqlime-examples")||(window.SqlimeExamples=a,customElements.define("sqlime-examples",a));})();
