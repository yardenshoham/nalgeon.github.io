<!doctype html><html lang=en>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1">
<title>ChatGPT Bot in Python</title>
<meta name=description content="A Telegram chatbot that works via the official OpenAI API.">
<meta name=robots content="index, follow">
<link rel=stylesheet type=text/css href=/assets/css/style.1298740fb12777af4ee1e867068ab1346fee55f55d941cd1726c640003698f1d.css>
<link rel=icon href=/assets/favicon/favicon.ico sizes=any>
<link rel=icon type=image/svg+xml href=/assets/favicon/favicon.svg>
<link rel=apple-touch-icon href=/assets/favicon/apple-touch-icon.png>
<link rel=manifest href=/assets/favicon/manifest.json>
<link rel=canonical href=https://antonz.org/pokitoki/>
<meta name=author content="Anton Zhiyanov">
<meta property="og:type" content="article">
<meta property="og:title" content="ChatGPT Bot in Python">
<meta property="og:description" content="A Telegram chatbot that works via the official OpenAI API.">
<meta property="og:url" content="https://antonz.org/pokitoki/">
<meta property="og:image" content="https://antonz.org/pokitoki/cover.png">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:title content="ChatGPT Bot in Python">
<meta name=twitter:description content="A Telegram chatbot that works via the official OpenAI API.">
<meta name=twitter:url content="https://antonz.org/pokitoki/">
<meta name=twitter:site content="@ohmypy">
<meta name=twitter:image content="https://antonz.org/pokitoki/cover.png"></head>
<body>
<div class=header>
<div class=container>
<div class=row>
<div class="col-xs-6 col-sm-3">
<a class=img-link href=/>
<img src=/assets/logo.svg class=header-icon>
</a>Â 
<a href=/>
<strong>Anton Zhiyanov</strong>
</a>
</div>
<div class="col-xs-12 col-sm-6 col-md-4 hidden-mobile">
<a class=menu__link href=/all/>
<span>blog</span>
</a>
<a class=menu__link href=/#about>
<span>contacts</span>
</a>
<a class=menu__link href=https://antonz.ru>
<span>ru</span>
</a>
</div>
<div class="col-xs-6 col-sm-3"><div class=search-module>
<form action=https://duckduckgo.com/>
<input type=hidden name=kf value=-1>
<input type=hidden name=kz value=-1>
<input type=hidden name=kaf value=1>
<input type=hidden name=ko value=-2>
<input type=hidden name=k1 value=-1>
<input type=hidden name=sites value=antonz.org>
<input type=search name=q autocomplete=off placeholder=Search aria-label=Search>
</form>
</div></div>
</div>
</div>
</div>
<div class=storey>
<div class=container>
<article class=post>
<div class=row>
<div class="col-xs-12 col-sm-10 article">
<header>
<h1>ChatGPT Bot in Python</h1>
</header>
<p>In the last few months, people have been releasing a record number of AI-powered software. Of course I could not stay out of it.</p>
<p>And so the <a href=https://github.com/nalgeon/pokitoki><strong>pokitoki</strong></a> project was born. It&rsquo;s a a Telegram chat bot built using the ChatGPT (GPT-3.5 or GPT-4) language model from OpenAI.</p>
<p>Notable features:</p>
<ul>
<li>Both one-on-one and group chats.</li>
<li>Direct questions, mentions, follow-ups.</li>
<li>Access external links (articles, code, data).</li>
<li>Shortcuts (custom AI commands).</li>
</ul>
<h2 id=personal-chats>Personal chats</h2>
<p>The bot acts as your personal assistant:</p>
<div class=row>
<div class="col-xs-12 col-sm-6">
<figure>
<img src=./chat-1.png alt="Sample chat" width=400 class=img-bordered-thin>
</figure>
</div>
</div>
<p>To allow other users to use the bot, list them in the <code>telegram_usernames</code> config property.</p>
<p>The bot has a terrible memory, so don&rsquo;t expect it to remember any chat context by default. You can, however, reply with a follow-up question (<code>Ctrl/Cmd + â†‘</code>). Alternatively, use a plus sign to follow up:</p>
<div class=row>
<div class="col-xs-12 col-sm-6">
<figure>
<img src=./chat-2.png alt="Follow-up by reply" width=400 class=img-bordered-thin>
<figcaption>follow up by replying<figcaption>
</figure>
</div>
<div class="col-xs-12 col-sm-6">
<figure>
<img src=./chat-3.png alt="Follow-up by plus sign" width=400 class=img-bordered-thin>
<figcaption>or by writing a `+` sign<figcaption>
</figure>
</div>
</div>
<p>Available commands:</p>
<ul>
<li><code>/retry</code> - retry answering the last question</li>
<li><code>/help</code> - show help</li>
<li><code>/version</code> - show bot info</li>
</ul>
<h2 id=groups>Groups</h2>
<p>To get an answer from the bot in a group, mention it in a reply to a question, or ask a question directly:</p>
<div class=row>
<div class="col-xs-12 col-sm-6">
<figure>
<img src=./chat-4.png alt="Reply with mention" width=400 class=img-bordered-thin>
<figcaption>reply with mention<figcaption>
</figure>
</div>
<div class="col-xs-12 col-sm-6">
<figure>
<img src=./chat-5.png alt="Direct question" width=400 class=img-bordered-thin>
<figcaption>direct question<figcaption>
</figure>
</div>
</div>
<p>To make the bot reply to group members, list the group id in the <code>telegram_chat_ids</code> config property. Otherwise, the bot will ignore questions from group members unless they are listed in the <code>telegram_usernames</code> config property.</p>
<p>If you don&rsquo;t know the group id, run the <code>/version</code> bot command in a group to find it:</p>
<pre tabindex=0><code>Chat information:
- id: -1001405001234
- title: My Favorite Group
- type: supergroup
...
</code></pre><h2 id=external-links>External links</h2>
<p>If you ask &ldquo;vanilla&rdquo; ChatGPT about external resources, it will either hallucinate or admit that it doesn&rsquo;t have access to remote content:</p>
<blockquote>
<p>Q: What is the content of <a href=https://sqlime.org/employees.sql?>https://sqlime.org/employees.sql?</a> Make no assumptions.</p>
<p>A: As an AI language model, I cannot access external URLs on the internet.</p>
</blockquote>
<p>The bot solves the problem by fetching the remote content and feeding it to the model:</p>
<div class=row>
<div class="col-xs-12 col-sm-6">
<figure>
<img src=./chat-7.png alt="External links" width=400 class=img-bordered-thin>
</figure>
</div>
</div>
<p>Currently only supports text content (articles, code, data), not PDFs, images or audio.</p>
<h2 id=shortcuts>Shortcuts</h2>
<p>Use short commands to save time and ask the bot to do something specific with your questions. For example, ask it to proofread your writing with a <code>!proofread</code> command:</p>
<div class=row>
<div class="col-xs-12 col-sm-6">
<figure>
<img src=./chat-6.png alt=Shortcuts width=400 class=img-bordered-thin>
</figure>
</div>
</div>
<p>There are several built-in shortcuts:</p>
<ul>
<li><code>bugfix</code> fixes your code.</li>
<li><code>proofread</code> fixes your writing.</li>
<li><code>translate</code> translates your text into English.</li>
<li><code>summarize</code> gives a two paragraph summary of a text.</li>
</ul>
<p>You can add your own shortcuts. See <code>config.example.yml</code> for details.</p>
<h2 id=other-useful-features>Other useful features</h2>
<p>The convenience of working with a bot is made up of small details. Here are some situations where it can save you time and effort.</p>
<h3 id=forwarding>Forwarding</h3>
<p>Say you received a message from a colleague or read a post on a channel and want to ask a question. Simply forward the message to the bot and answer the clarifying question it asks:</p>
<div class=row>
<div class="col-xs-12 col-sm-6">
<figure>
<img src=./chat-8.png alt="Forwarding 1" width=400 class=img-bordered-thin>
<figcaption>forward the message<figcaption>
</figure>
</div>
<div class="col-xs-12 col-sm-6">
<figure>
<img src=./chat-9.png alt="Forwarding 2" width=400 class=img-bordered-thin>
<figcaption>and specify the task<figcaption>
</figure>
</div>
</div>
<h3 id=reply-with-attachment>Reply with attachment</h3>
<p>Sometimes the AI&rsquo;s reply exceeds the maximum message length set by Telegram. In this case, the bot will not fail or spam you with messages. Instead, it will send the answer as an attached markdown file:</p>
<div class=row>
<div class="col-xs-12 col-sm-6">
<figure>
<img src=./chat-10.png alt="Reply with attachment" width=400 class=img-bordered-thin>
</figure>
</div>
</div>
<h3 id=editing-questions>Editing questions</h3>
<p>To rephrase or add to the last question, edit it (<code>â†‘</code> shortcut). The bot will notice this and respond to the clarified question.</p>
<h2 id=bot-information>Bot information</h2>
<p>Use the <code>/version</code> commands to print detailed information about the current chat, bot, and AI model:</p>
<pre tabindex=0><code>Chat information:
- id: -1001405001234
- title: My Favorite Group
- type: supergroup

Bot information:
- id: 5930739038
- name: @pokitokibot
- version: 70
- usernames: 6 users
- chat IDs: []
- access to messages: True

AI information:
- model: gpt-3.5-turbo
- history depth: 3
- shortcuts: ['bugfix', 'proofread', 'summarize', 'translate']
</code></pre><h2 id=setup>Setup</h2>
<ol>
<li>Get your <a href=https://openai.com/api/>OpenAI API</a> key</li>
<li>Get your Telegram bot token from <a href=https://t.me/BotFather>@BotFather</a></li>
<li>Copy <code>config.example.yml</code> to <code>config.yml</code> and specify your tokens there.</li>
<li>Start the bot:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker compose up --build --detach
</code></pre></div><p>To stop the bot:</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker compose stop
</code></pre></div><p>For older Docker distributions, use <code>docker-compose</code> instead of <code>docker compose</code>.</p>
<p><a href=https://github.com/nalgeon/pokitoki>Source code on GitHub</a></p>
<p><em>Follow <a href=https://twitter.com/ohmypy><strong>@ohmypy</strong></a> on Twitter to keep up with new posts</em>Â ðŸš€</p>
</div>
</div><footer class=post__footer>
<div class=row>
<div class=col-xs-12>
<div class=post__date>
<time datetime="2023-03-11 12:30:00 +0000 UTC">11 Mar, 2023</time>
</div>
<div class=post__tags>
<a href=https://antonz.org/tags/python/>python</a>&nbsp;
</div>
</div>
</div>
</footer></article>
<aside class=post__related>
<div class="post__nav article">
<div class=row>
<div class="col-xs-12 col-sm-6">
<p>&larr;&nbsp;<a href=https://antonz.org/interactive-sql-examples/>Interactive SQL Examples in JavaScript</a></p>
</div>
<div class="col-xs-12 col-sm-6">
<p><a href=https://antonz.org/sqlime-ai/>AI SQLite Assistant</a>&nbsp;&rarr;</p>
</div>
</div>
</div>
<div class=article>
<div class=row>
<div class="col-xs-12 col-sm-8 col-md-6">
<h3>See also</h3>
<p><a href=/json-lines/>JSON Lines</a></p>
<p><a href=/ellipsis/>Expressive Ellipsis in Python</a></p>
<p><a href=/protocol/>Flying Pig, or Protocols in Python</a></p>
</div>
</div>
</div>
</aside>
</div>
</div>
<footer class="container footer">
<ul class=naked-list>
<li class=footer__item>Subscribe:
<a href=https://twitter.com/ohmypy class=footer__social-link>
<i class="fab fa-twitter-1"></i><span>Twitter</span>
</a>
<a href=https://github.com/nalgeon class=footer__social-link>
<i class="fab fa-github-1"></i><span>GitHub</span>
</a>
<a href=https://www.linkedin.com/in/nalgeon/ class=footer__social-link>
<i class="fab fa-linkedin-2"></i><span>LinkedIn</span>
</a>
<a href=/index.xml class=footer__social-link><i class="fas fa-rss"></i><span>RSS</span></a>
</li>
<li class=footer__item>Email: <a href=mailto:m@antonz.org>m@antonz.org</a></li>
</ul>
</footer>
<script async src=//gc.zgo.at/count.js data-goatcounter=https://antonzorg.goatcounter.com/count></script></body>
</html>